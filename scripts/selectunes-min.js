$(document).ready(function(){function n(){$.mobile.changePage("#page","fade")}function r(){$.mobile.loading("show",{text:"Loading Available Venues",textVisible:true,theme:"a",html:""});$.getJSON(e+"venue/").done(function(e){$.each(e,function(e,t){owner.Id=t.ownerID;owner.Name=t.ownerName;$("<li id="+owner.Id+'><a><img src="css/images/nightlife.jpg" class="ui-li-thumb"><h2 id="ownerVenueName" class="ui-li-heading">'+owner.Name+'</h2><p class="ui-li-desc">More Info Here</p></a></li>').appendTo($("#venueview"));$.mobile.hidePageLoadingMsg();$("#venueview").listview("refresh")})})}function i(){var t=trac.Id;$.getJSON(e+"playing?ownerid="+owner.Id).done(function(e){$.each(e,function(e,n){trac={Id:n.Id,Name:n.Name,Artist:n.Artist};if(t!=trac.Id){$("#playing").empty();$('<li style="font-size:16px">Now Playing</li>').appendTo($("#playing"));$("<li id ="+trac.Id+' class="ui-li ui-li-static ui-btn-up-c ui-li-has-thumb"><img id='+trac.Logo+' src="css/images/nightlife.jpg" class="ui-li-thumb"><h2 class="ui-li-heading">'+trac.Name+'</h2><p class="ui-li-desc"> '+trac.Artist+"</p></li>").appendTo($("#playing"));$("#playing").listview("refresh")}})});setTimeout(i,1e4)}function s(){$.getJSON(e+"trackingtracks/"+owner.Id).done(function(e){o(e)})}function o(e){$("#listView").empty();if(!e){$("#listView").html("<p> No Data Found </p>");return}(function t(n){$.mobile.hidePageLoadingMsg();trac={Id:e[n].Id,Name:e[n].Name,Artist:e[n].Artist};$("<li id="+trac.Id+"><a><h4>"+trac.Name+"</h4><p>"+trac.Artist+"</p></a></li>").appendTo($("#listView"));setTimeout(function(){if(++n<e.length){t(n)}else{$("#listView").listview("refresh")}},5)})(0)}var e="http://selectunes-api.azurewebsites.net/api/";var t=0;trac={Id:"",Name:"",Logo:"",Artist:""};owner={Id:"",Name:""};$(function(){setTimeout(n,2500)});$(function(){setTimeout(r,3e3)});$("#venueview").on("click","li",function(){function t(){$.getJSON(e+"playing?ownerid="+owner.Id).done(function(e){$.each(e,function(e,t){trac={Id:t.Id,Name:t.Name,Artist:t.Artist};$("<li id ="+trac.Id+' class="ui-li ui-li-static ui-btn-up-c ui-li-has-thumb"><img id='+trac.Logo+' src="css/images/nightlife.jpg" class="ui-li-thumb"><h2 class="ui-li-heading">'+trac.Name+'</h2><p class="ui-li-desc"> '+trac.Artist+"</p></li>").appendTo($("#playing"));$("#playing").listview("refresh")})})}$("#playing").empty();$('<li style="font-size:16px">Now Playing</li>').appendTo($("#playing"));owner.Id=$(this).attr("id");owner.Name=$("#ownerVenueName").text();$("#venueName").text(owner.Name);$.mobile.changePage("#page2","pop");$("#ownerInfo").text("Welcome to our venue");$("#ownerInstruct").text("Tap record below to Select!");$(function(){setTimeout(t,0)});s()});i();$("#nextTrackList").on("click","li",function(){$("#nextTrackList").empty();$('<li style="font-size:16px"><a id="upNext">Selected Upcoming Tracks<span class="ui-li-count ui-btn-up-c ui-btn-corner-all">Show</span></a></li>').appendTo($("#nextTrackList"));$.getJSON(e+"playing?ownerid="+owner.Id).done(function(e){$.each(e,function(e,t){trac={Id:t.Id,Name:t.Name,Artist:t.Artist};$("<li id ="+trac.Id+' class="ui-li ui-li-static ui-btn-up-c ui-li-has-thumb"><img id='+trac.Logo+' src="css/images/nightlife.jpg" class="ui-li-thumb"><h2 class="ui-li-heading">'+trac.Name+'</h2><p class="ui-li-desc"> '+trac.Artist+"</p></li>").appendTo($("#nextTrackList"));$("#nextTrackList").listview("refresh")})})});$("#selectTrack").on("click",this,function(){$("#venueName2").text(owner.Name);$.mobile.changePage("#page3","pop");$("#tracks").removeClass("ui-disabled");$("#artists").addClass("ui-disabled");$("#artistView").empty();$("#artistList").empty();$("#trackView").css("display","none");$("#listView").css("display","none");$("#artistView").css("display","block");$.mobile.loading("show",{text:"Loading Available Artists",textVisible:true,theme:"a",html:""});$.getJSON(e+"artist/"+owner.Id).done(function(e){$.each(e,function(e,t){art={Id:t.Id,Name:t.Name,Tracks:t.TrackCount};$("<li id="+art.Id+"><a>"+art.Name+'<span class="ui-li-count ui-btn-up-c ui-btn-corner-all">Tracks '+art.Tracks+" </span></a></li>").appendTo($("#artistView"));$.mobile.hidePageLoadingMsg();$("#artistView").listview("refresh")})})});$("#artists").on("click",this,function(){$("#tracks").removeClass("ui-disabled");$("#artists").addClass("ui-disabled");$("#artistView").empty();$("#artistView").css("display","block");$("#trackView").css("display","none");$("#listView").css("display","none");$.mobile.loading("show",{text:"Loading Available Artists",textVisible:true,theme:"a",html:""});$.getJSON(e+"artist/"+owner.Id).done(function(e){$.each(e,function(e,t){art={Id:t.Id,Name:t.Name,Tracks:t.TrackCount};$("<li id="+art.Id+"><a>"+art.Name+'<span class="ui-li-count ui-btn-up-c ui-btn-corner-all">Tracks '+art.Tracks+" </span></a></li>").appendTo($("#artistView"));$.mobile.hidePageLoadingMsg();$("#artistView").listview("refresh")})})});$("#tracks").on("click",this,function(){$("#tracks").addClass("ui-disabled");$("#artists").removeClass("ui-disabled");$("#trackView").empty();$("#artistView").css("display","none");$("#trackView").css("display","none");$("#listView").css("display","block");$("#listView").listview("refresh")});$("#listView").on("click","li",function(){track={Id:$(this).attr("id"),Name:$(this).text()};var t=track.Id;var n=""+t+"a";$("#listview").listview("refresh");$.support.cors=true;$.ajax({url:e+"selecttracks/",type:"POST",data:JSON.stringify("="+track.Id.toString()),dataType:"json",contentType:"application/json;charset=utf-8",success:function(e){alert("Your Track will play Shortly")},error:function(e,t){alert("Failed")}})});$("#artistView").on("click","li",function(){$("#artistView").empty();$("#artistList").empty();$("#trackView").css("display","none");$("#artistList").css("display","block");$.mobile.loading("show",{text:"Loading Tracks",textVisible:true,theme:"a",html:""});artist={Id:$(this).attr("id")};$.getJSON(e+"artist?ownerid="+owner.Id+"&artistid="+artist.Id).done(function(e){$.each(e,function(e,t){trac={Id:t.Id,Name:t.Name};$("<li id="+trac.Id+"><a id="+trac.Id+"a>"+trac.Name+"</a></li>").appendTo($("#artistList"));$.mobile.hidePageLoadingMsg();$("#artistList").listview("refresh")})})});$("#artistList").on("click","li",function(){track={Id:$(this).attr("id"),Name:$(this).text()};var t=track.Id;var n=""+t+"a";$("#artistList").listview("refresh");$.support.cors=true;$.ajax({url:e+"selecttracks/",type:"POST",data:JSON.stringify("="+track.Id.toString()),dataType:"json",contentType:"application/json;charset=utf-8",success:function(e){alert("Your Track will play Shortly")},error:function(e,t){alert("Failed")}})})})